# 要件定義

## 背景
- Mahjong Toolkit をスマホ専用 UI で提供し、GitHub Pages 上で動作させる。
- 現状はツールを 1 ページにまとめているが、トップページ＋各ツール個別ページへ分割する。

## 対象ユーザー・利用シーン
- 個人の趣味利用。オンライン/リアル卓を問わず、その場で点数確認や形確認をしたいプレイヤー。
- 学習・研究用途での牌理/役確認、簡易 EV チェック。
- PC で開いた場合もスマホ幅を維持（横幅が広くてもモバイルレイアウト固定）。

## 機能要件（Must）
- トップページ
  - 各ツールへの導線（カード or リスト形式）。
  - 主要ツールの概要と使用時の前提（ドラッグなし、タップ主体）。
- 各ツールはそれぞれ独立したページ（Vue Router 予定）:
  - 点数計算/符計算
  - 待ち牌/受け入れ枚数チェッカー
  - 役一覧/検索
  - 点差逆転シミュレーター
  - 何切る練習（簡易）
  - 牌理可視化
  - 点数早見表（翻×符）
  - リーチ vs ダマ簡易 EV
  - 点棒管理
  - 牌譜ビューア（簡易 JSON リプレイ）
- ナビゲーション
  - ヘッダーにホームへの戻りとツール切替ナビを配置。
  - スマホで片手操作を想定し、主要操作は縦スクロールとタップのみで完結。
- 入力方法
  - 牌入力はテキスト/ボタンのタップのみで完結（ドラッグ必須を避ける）。

## 非機能要件
- GitHub Pages でホスト可能（クライアントサイドのみ）。
- オフライン対応: 全ツールをネットワーク不要で動作させる。Service Worker によるキャッシュを維持。
- モバイルファースト: 360–430px 幅で快適に使える UI。PC でもモバイル幅を維持。
- パフォーマンス: ルート単位で遅延読み込みし初期バンドルを抑制。画像は最小限。
- 言語: 日本語のみ。切り替え不要。
- 端末: 最新の iOS Safari / Android Chrome を主対象（下位互換は無保証）。

## スコープ外（Won't）
- ログイン/サーバ保存。
- 本格的な統計シミュレーション（EV はテーブルベースの簡易計算）。
- 他サイトからの自動牌譜取得（貼り付け入力のみ）。
- 広告/トラッキング配信（GitHub Pages 想定のため非対応）。

## UI/デザイン要件
- シンプル重視。色合いは選択式を検討（例: Mリーグ各チームのイメージカラーなどのテーマ切替）。
- 操作はタップ＋テキスト入力のみで完結（ドラッグ必須操作を避ける）。

## 各ツールの入力/出力（案）
- 点数計算/符計算: 入力=翻,符,親/子,ツモ/ロン; 出力=支払点（親/子/ツモ配分）、満貫以上の種別。
- 待ち牌/受け入れ: 入力=手牌13枚（テキスト/タップ）, ドラ考慮はなし; 出力=待ち牌リストと残り枚数、合計受け入れ。14枚の場合は簡易何切る提案。
- 役一覧: 入力=検索文字列/タグ; 出力=役名,翻数,条件。
- 点差逆転シミュ: 入力=自分/相手点数, 親/子, ツモ/ロン; 出力=必要加点と翻/符の例。
- 何切る練習: 入力=問題選択、解答選択; 出力=推奨手と簡易理由、形解析/受け入れ参考。
- 牌理可視化: 入力=手牌; 出力=刻子/順子/対子/孤立牌リスト。
- 点数早見表: 入力=翻; 出力=符ごとの支払点表。
- リーチ vs ダマ EV: 入力=翻/符, 親/子, 和了率, 放銃率, 失点想定; 出力=簡易EV比較と差分。
- 点棒管理: 入力=各プレイヤー点数増減; 出力=現在点数。
- 牌譜ビューア: 入力=簡易JSON牌譜; 出力=ステップ再生とアクションログ。

## 画面/遷移
- トップページ: ツール一覧カード、ナビゲーション。
- `/tools/score`, `/tools/ukeire`, `/tools/yaku`, `/tools/endgame`, `/tools/practice`, `/tools/shape`, `/tools/ref`, `/tools/ev`, `/tools/tracker`, `/tools/replay` の各個別ページ。
- 共通ヘッダー/フッターにホームへの導線とツール一覧リンクを配置。モバイル幅での戻り導線を明示。

## 品質/テスト
- TypeScript で型安全を確保。
- コアロジック（待ち判定/点数計算）はユニットテストを用意（後続作業）。
- 画面遷移とルーティングのスモーク確認を手動で実施。
